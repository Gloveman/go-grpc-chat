syntax = "proto3";

package chat;
option go_package="github.com/Gloveman/go-grpc-chat/chatpb";

service ChatService {
    // 채팅방 입장 - 서버에 입장 요청, 클라이언트에 메시지 스트림 반환
    rpc JoinRoom(JoinRequest) returns (stream ChatMessage);
    // 메시지 전송 - 메시지 전송 및 전송 결과 반환
    rpc SendMessage(ChatMessage) returns (SendResponse);
    // 방 목록 조회
    rpc GetRoomsInfo(RoomsInfoRequest) returns (RoomsInfoResponse);

}

message RoomInfo {
    int32 room_id = 1;
    string room_name = 2;
    int32 client_count = 3;
}

message JoinRequest {
    string user_name = 1;
    int32 room_id = 2;
    string room_name = 3;
}

message ChatMessage {
    string sender_user_name = 1;
    string message_text = 2;
    int32 room_id = 3;
}

message SendResponse {
    bool success = 1;
}

message RoomsInfoRequest {
    //방 필터링 시 파라미터 추가
}

message RoomsInfoResponse {
    repeated RoomInfo rooms = 1;
}
